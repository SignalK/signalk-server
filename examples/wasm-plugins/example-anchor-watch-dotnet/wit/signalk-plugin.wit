// Signal K WASM Plugin Interface Definition
// This WIT file defines the interface that Signal K WASM plugins must implement

package signalk:plugin@1.0.0;

/// The main plugin interface that all Signal K WASM plugins must export
interface plugin {
    /// Returns the unique plugin identifier (e.g., "anchor-watch-dotnet")
    plugin-id: func() -> string;

    /// Returns the human-readable plugin name (e.g., "Anchor Watch (.NET)")
    plugin-name: func() -> string;

    /// Returns the JSON schema for plugin configuration
    plugin-schema: func() -> string;

    /// Called when the plugin is started with configuration JSON
    /// Returns 0 on success, non-zero on error
    plugin-start: func(config: string) -> s32;

    /// Called when the plugin is stopped
    /// Returns 0 on success, non-zero on error
    plugin-stop: func() -> s32;
}

/// Signal K host API functions that plugins can import
interface signalk-api {
    /// Log a debug message
    sk-debug: func(message: string);

    /// Set plugin status message
    sk-set-status: func(message: string);

    /// Set plugin error message
    sk-set-error: func(message: string);

    /// Emit a Signal K delta message (JSON string)
    sk-handle-message: func(delta-json: string);

    /// Register a PUT handler for a path
    /// Returns 1 on success, 0 on failure
    sk-register-put-handler: func(context: string, path: string) -> s32;
}

/// World definition for Signal K plugins
world signalk-plugin {
    /// Import the Signal K host API
    import signalk-api;

    /// Export the plugin interface
    export plugin;
}
