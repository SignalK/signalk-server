{
  "openapi": "3.1.0",
  "info": {
    "title": "Mayara Radar API",
    "description": "REST API for controlling marine radars. Supports Navico (Simrad, B&G, Lowrance), Furuno, and Raymarine radar systems. Provides endpoints for discovering radars, reading and setting control values, and accessing radar data via WebSocket streams.",
    "license": {
      "name": "Apache-2.0",
      "identifier": "Apache-2.0"
    },
    "version": "2.0.0"
  },
  "paths": {
    "/signalk/v1/stream": {
      "get": {
        "tags": [
          "Stream"
        ],
        "summary": "Real-time control stream (WebSocket)",
        "description": "WebSocket endpoint for real-time bidirectional radar control communication.\n\n## Connection\nConnect via WebSocket to receive real-time control value updates.\n\n## Query Parameters\n- `subscribe`: Initial subscription mode\n- `all` (default): Subscribe to all control updates\n- `self`: Subscribe to updates for the current vessel\n- `none`: No initial subscriptions\n- `sendCachedValues`: Send current values on connect\n- `true` (default): Send all current control values immediately\n- `false`: Only send future updates\n\n## Client → Server Messages\n\n### Set Control Value\nSend a control command to change a radar setting:\n```json\n{\n\"path\": \"radars.nav1034A.controls.gain\",\n\"value\": 50\n}\n```\n\nFor guard zones, include additional fields:\n```json\n{\n\"path\": \"radars.nav1034A.controls.guardZone1\",\n\"value\": 0,\n\"endValue\": 90,\n\"startDistance\": 100,\n\"endDistance\": 500,\n\"enabled\": true\n}\n```\n\n### Subscribe to Updates\nSubscribe to specific control paths with optional rate limiting:\n```json\n{\n\"subscribe\": [\n{\"path\": \"radars.*.controls.*\", \"period\": 1000},\n{\"path\": \"radars.nav1034A.controls.gain\", \"policy\": \"instant\"}\n]\n}\n```\n\nPath patterns support wildcards:\n- `radars.*.controls.*` - all controls on all radars\n- `radars.nav1034A.controls.*` - all controls on specific radar\n- `*.gain` - gain control on all radars\n\nSubscription options:\n- `period`: Update interval in milliseconds (for fixed policy)\n- `minPeriod`: Minimum interval between updates\n- `policy`: Delivery policy\n- `instant`: Send immediately when value changes\n- `ideal`: Rate-limit to minPeriod\n- `fixed`: Send at fixed intervals\n\n### Unsubscribe\n```json\n{\n\"desubscribe\": [{\"path\": \"radars.*.controls.gain\"}]\n}\n```\n\n## Server → Client Messages\n\n### Delta Updates\nControl value changes are sent as delta messages:\n```json\n{\n\"updates\": [{\n\"$source\": \"mayara\",\n\"timestamp\": \"2024-01-15T10:30:00Z\",\n\"values\": [\n{\"path\": \"radars.nav1034A.controls.gain\", \"value\": 50},\n{\"path\": \"radars.nav1034A.controls.sea\", \"value\": 30, \"auto\": true}\n]\n}]\n}\n```\n\n### Metadata\nOn first connection, metadata describing each control is sent:\n```json\n{\n\"updates\": [{\n\"$source\": \"mayara\",\n\"meta\": [\n{\"path\": \"radars.nav1034A.controls.gain\", \"value\": {\"controlId\": \"gain\", \"type\": \"numeric\", ...}}\n]\n}]\n}\n```",
        "operationId": "control_stream_docs",
        "parameters": [
          {
            "name": "subscribe",
            "in": "query",
            "description": "Initial subscription mode: 'all', 'self', or 'none'",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sendCachedValues",
            "in": "query",
            "description": "Send cached values on connect: 'true' or 'false'",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "101": {
            "description": "Switching Protocols - WebSocket connection established"
          }
        }
      }
    },
    "/signalk/v2/api/vessels/self/radars": {
      "get": {
        "tags": [
          "Radars"
        ],
        "summary": "List all active radars",
        "description": "Returns all radars that have been detected on the network and are currently online. Each radar entry includes WebSocket URLs for accessing spoke data and control streams.",
        "operationId": "get_radars",
        "responses": {
          "200": {
            "description": "Map of radar IDs to radar information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RadarsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/signalk/v2/api/vessels/self/radars/interfaces": {
      "get": {
        "tags": [
          "Configuration"
        ],
        "summary": "List network interfaces",
        "description": "Returns information about which network interfaces are available and which radar brands are listening on each interface. Useful for diagnosing network configuration issues.",
        "operationId": "get_interfaces",
        "responses": {
          "200": {
            "description": "Network interface status for each radar brand",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RadarInterfaces"
                }
              }
            }
          }
        }
      }
    },
    "/signalk/v2/api/vessels/self/radars/{radar_id}/capabilities": {
      "get": {
        "tags": [
          "Radars"
        ],
        "summary": "Get radar capabilities",
        "description": "Returns static information about a specific radar including supported ranges, spoke resolution, Doppler support, and available controls. This information does not change during radar operation.",
        "operationId": "get_radar",
        "parameters": [
          {
            "name": "radar_id",
            "in": "path",
            "description": "Radar identifier (e.g., 'nav1034A')",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "nav1034A"
          }
        ],
        "responses": {
          "200": {
            "description": "Radar capabilities and control definitions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Capabilities"
                }
              }
            }
          },
          "404": {
            "description": "Radar not found"
          }
        }
      }
    },
    "/signalk/v2/api/vessels/self/radars/{radar_id}/controls": {
      "get": {
        "tags": [
          "Controls"
        ],
        "summary": "Get all control values",
        "description": "Returns the current values of all radar controls for a specific radar. Controls include settings like Gain, Sea, Rain, Range, and operational modes.",
        "operationId": "get_control_values",
        "parameters": [
          {
            "name": "radar_id",
            "in": "path",
            "description": "Radar identifier",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "nav1034A"
          }
        ],
        "responses": {
          "200": {
            "description": "All control values keyed by control name",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FullSignalKResponse"
                }
              }
            }
          },
          "404": {
            "description": "Radar not found"
          }
        }
      }
    },
    "/signalk/v2/api/vessels/self/radars/{radar_id}/controls/{control_id}": {
      "get": {
        "tags": [
          "Controls"
        ],
        "summary": "Get a control value",
        "description": "Returns the current value and state of a specific radar control.",
        "operationId": "get_control_value",
        "parameters": [
          {
            "name": "radar_id",
            "in": "path",
            "description": "Radar identifier",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "nav1034A"
          },
          {
            "name": "control_id",
            "in": "path",
            "description": "Control identifier",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "Gain"
          }
        ],
        "responses": {
          "200": {
            "description": "Current control value and state",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ControlValue"
                }
              }
            }
          },
          "400": {
            "description": "Unknown control name"
          },
          "404": {
            "description": "Radar not found"
          }
        }
      },
      "put": {
        "tags": [
          "Controls"
        ],
        "summary": "Set a control value",
        "description": "Sets the value of a specific radar control. The request body varies by control type: simple controls use 'value', controls with auto mode use 'value' and 'auto', guard zones use 'value', 'endValue', 'startDistance', 'endDistance', and 'enabled'.",
        "operationId": "set_control_value",
        "parameters": [
          {
            "name": "radar_id",
            "in": "path",
            "description": "Radar identifier",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "nav1034A"
          },
          {
            "name": "control_id",
            "in": "path",
            "description": "Control identifier (e.g., gain, range, sea, guardZone1, ...)",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "gain"
          }
        ],
        "requestBody": {
          "description": "Control value to set",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ControlValue"
              },
              "example": {
                "auto": false,
                "value": 50
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Control value set successfully"
          },
          "400": {
            "description": "Invalid control name or value out of range"
          },
          "404": {
            "description": "Radar not found"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AutomaticValue": {
        "type": "object",
        "required": [
          "hasAutoAdjustable"
        ],
        "properties": {
          "autoAdjustMaxValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double"
          },
          "autoAdjustMinValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double"
          },
          "hasAuto": {
            "type": "boolean"
          },
          "hasAutoAdjustable": {
            "type": "boolean"
          }
        }
      },
      "Brand": {
        "type": "string",
        "enum": [
          "Furuno",
          "Garmin",
          "Navico",
          "Raymarine"
        ]
      },
      "Capabilities": {
        "type": "object",
        "description": "Static capabilities and configuration of a radar unit",
        "required": [
          "maxRange",
          "minRange",
          "supportedRanges",
          "spokesPerRevolution",
          "maxSpokeLength",
          "pixelValues",
          "legend",
          "hasDoppler",
          "hasDualRange",
          "hasDualRadar",
          "noTransmitSectors",
          "controls"
        ],
        "properties": {
          "controls": {
            "type": "object",
            "description": "Map of control IDs to their definitions and current state",
            "additionalProperties": {
              "$ref": "#/components/schemas/Control"
            },
            "propertyNames": {
              "type": "integer",
              "enum": [
                0,
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                43,
                44,
                45,
                46,
                47,
                48,
                49,
                50,
                51,
                52,
                53
              ]
            }
          },
          "hasDoppler": {
            "type": "boolean",
            "description": "Whether this radar supports Doppler velocity detection",
            "example": true
          },
          "hasDualRadar": {
            "type": "boolean",
            "description": "Whether this is part of a dual-radar system",
            "example": false
          },
          "hasDualRange": {
            "type": "boolean",
            "description": "Whether this radar supports simultaneous dual-range operation",
            "example": true
          },
          "legend": {
            "$ref": "#/components/schemas/Legend",
            "description": "Color mapping legend for interpreting spoke data (pixel value to color/type mapping)"
          },
          "maxRange": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum supported range in meters",
            "example": 74080,
            "minimum": 0
          },
          "maxSpokeLength": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum number of samples per spoke",
            "example": 1024,
            "minimum": 0
          },
          "minRange": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum supported range in meters",
            "example": 50,
            "minimum": 0
          },
          "noTransmitSectors": {
            "type": "integer",
            "format": "int32",
            "description": "Number of configurable no-transmit sectors",
            "example": 2,
            "minimum": 0
          },
          "pixelValues": {
            "type": "integer",
            "format": "int32",
            "description": "Number of distinct pixel intensity values",
            "example": 16,
            "minimum": 0
          },
          "spokesPerRevolution": {
            "type": "integer",
            "format": "int32",
            "description": "Number of spokes (radial lines) per full rotation",
            "example": 2048,
            "minimum": 0
          },
          "supportedRanges": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            },
            "description": "List of all supported range values in meters",
            "example": [
              50,
              75,
              100,
              250,
              500,
              750,
              1000,
              1500,
              2000,
              3000
            ]
          }
        },
        "example": {
          "controls": {},
          "hasDoppler": true,
          "hasDualRadar": false,
          "hasDualRange": true,
          "legend": {
            "dopplerApproaching": 18,
            "dopplerReceding": 19,
            "historyStart": 20,
            "lowReturn": 1,
            "mediumReturn": 8,
            "pixelColors": 16,
            "strongReturn": 13,
            "targetBorder": 17
          },
          "maxRange": 74080,
          "maxSpokeLength": 1024,
          "minRange": 50,
          "noTransmitSectors": 2,
          "pixelValues": 16,
          "spokesPerRevolution": 2048,
          "supportedRanges": [
            50,
            75,
            100,
            250,
            500,
            750,
            1000,
            1500,
            2000,
            3000,
            4000,
            6000,
            8000,
            12000,
            16000,
            24000,
            36000,
            48000,
            64000,
            74080
          ]
        }
      },
      "Category": {
        "type": "string",
        "enum": [
          "base",
          "targets",
          "guardZones",
          "trails",
          "advanced",
          "installation",
          "info"
        ]
      },
      "Color": {
        "type": "object",
        "required": [
          "r",
          "g",
          "b",
          "a"
        ],
        "properties": {
          "a": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "b": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "g": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "r": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "Control": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ControlDefinition"
          }
        ]
      },
      "ControlDataType": {
        "type": "string",
        "enum": [
          "number",
          "enum",
          "string",
          "button",
          "sector",
          "zone"
        ]
      },
      "ControlDefinition": {
        "allOf": [
          {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/AutomaticValue"
              }
            ]
          },
          {
            "type": "object",
            "required": [
              "id",
              "name",
              "description",
              "category",
              "dataType"
            ],
            "properties": {
              "category": {
                "$ref": "#/components/schemas/Category"
              },
              "dataType": {
                "$ref": "#/components/schemas/ControlDataType"
              },
              "description": {
                "type": "string"
              },
              "descriptions": {
                "type": [
                  "object",
                  "null"
                ],
                "additionalProperties": {
                  "type": "string"
                },
                "propertyNames": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "hasEnabled": {
                "type": "boolean"
              },
              "id": {
                "type": "integer",
                "format": "int32",
                "minimum": 0
              },
              "isReadOnly": {
                "type": "boolean"
              },
              "maxDistance": {
                "type": [
                  "number",
                  "null"
                ],
                "format": "double"
              },
              "maxValue": {
                "type": [
                  "number",
                  "null"
                ],
                "format": "double"
              },
              "minValue": {
                "type": [
                  "number",
                  "null"
                ],
                "format": "double"
              },
              "name": {
                "type": "string"
              },
              "stepValue": {
                "type": [
                  "number",
                  "null"
                ],
                "format": "double"
              },
              "units": {
                "oneOf": [
                  {
                    "type": "null"
                  },
                  {
                    "$ref": "#/components/schemas/Units"
                  }
                ]
              },
              "validValues": {
                "type": [
                  "array",
                  "null"
                ],
                "items": {
                  "type": "integer",
                  "format": "int32"
                }
              }
            }
          }
        ]
      },
      "ControlValue": {
        "type": "object",
        "description": "Radar control value used by the Signal K REST API\n\nDifferent control types use different fields:\n- Simple controls: `value` (numeric or string)\n- Auto-capable controls: `value`, `auto`, possibly `autoValue`\n- sectors: `value` (angle start), `endValue` (angle end)\n- zones: `value` (angle start), `endValue` (angle end), `startDistance`, `endDistance`, `enabled`\n\nNumeric controls may send `units` when not in SI and control definition\nhas units specified.\n",
        "properties": {
          "auto": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Whether automatic mode is enabled (for Gain, Sea, Rain, etc.)",
            "example": false
          },
          "autoValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "Adjustment of the auto algorithm when auto=true",
            "example": -5.0
          },
          "enabled": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Whether the user has enabled the control",
            "example": true
          },
          "endDistance": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "Outer radius for zones (meters)",
            "example": 500.0
          },
          "endValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "End angle for sector and zone (radians)",
            "example": 0.78593
          },
          "startDistance": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "Inner radius for zones (meters)",
            "example": 100.0
          },
          "value": {
            "description": "The control value (numeric for most controls, string for some modes)"
          }
        },
        "example": {
          "allowed": true,
          "auto": false,
          "value": 50
        }
      },
      "DeltaMeta": {
        "type": "object",
        "description": "Control metadata containing schema definitions",
        "required": [
          "path",
          "value"
        ],
        "properties": {
          "path": {
            "type": "string",
            "description": "Full path to the control",
            "example": "radars.nav1034A.controls.gain"
          },
          "value": {
            "$ref": "#/components/schemas/ControlDefinition",
            "description": "Control definition including type, range, and valid values"
          }
        }
      },
      "DeltaUpdate": {
        "type": "object",
        "description": "A batch of control value updates within a SignalKDelta message",
        "properties": {
          "meta": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeltaMeta"
            },
            "description": "Control metadata (schema definitions, sent once per radar)"
          },
          "values": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeltaValue"
            },
            "description": "Control value changes"
          }
        }
      },
      "DeltaValue": {
        "type": "object",
        "description": "A single control value update",
        "required": [
          "path",
          "value"
        ],
        "properties": {
          "path": {
            "type": "string",
            "description": "Full path to the control (e.g., \"radars.nav1034A.controls.gain\")",
            "example": "radars.nav1034A.controls.gain"
          },
          "value": {
            "$ref": "#/components/schemas/ControlValue",
            "description": "The control value"
          }
        },
        "example": {
          "path": "radars.nav1034A.controls.gain",
          "value": 50
        }
      },
      "Desubscription": {
        "type": "object",
        "description": "Client-to-server message to unsubscribe from control value updates",
        "required": [
          "desubscribe"
        ],
        "properties": {
          "desubscribe": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PathSubscribe"
            },
            "description": "List of paths to unsubscribe from"
          }
        },
        "example": {
          "desubscribe": [
            {
              "path": "radars.*.controls.gain"
            }
          ]
        }
      },
      "FullSignalKResponse": {
        "type": "object",
        "description": "Signal K formatted response wrapper",
        "required": [
          "version",
          "radars"
        ],
        "properties": {
          "radars": {
            "description": "Radar data nested by radar ID"
          },
          "version": {
            "type": "string",
            "description": "API version",
            "example": "3.0.0"
          }
        },
        "example": {
          "radars": {
            "nav1034A": {
              "controls": {
                "gain": {
                  "auto": false,
                  "value": 50
                },
                "range": {
                  "value": 3000
                },
                "sea": {
                  "allowed": true,
                  "auto": true,
                  "autoValue": 25,
                  "value": 30
                }
              }
            }
          },
          "version": "3.0.0"
        }
      },
      "InterfaceApi": {
        "type": "object",
        "description": "API response containing network interface information for radar detection",
        "required": [
          "brands",
          "interfaces"
        ],
        "properties": {
          "brands": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Brand"
            },
            "description": "Set of radar brands that have been compiled into this server",
            "example": [
              "Navico",
              "Furuno"
            ],
            "uniqueItems": true
          },
          "interfaces": {
            "type": "object",
            "description": "Map of network interface name to its radar listener information",
            "additionalProperties": {
              "$ref": "#/components/schemas/RadarInterfaceApi"
            },
            "propertyNames": {
              "type": "string"
            }
          }
        },
        "example": {
          "brands": [
            "Navico",
            "Furuno"
          ],
          "interfaces": {
            "en0": {
              "ip": "192.168.1.100",
              "listeners": {
                "Furuno": "No match for 172.31.255.255",
                "Navico": "Active"
              },
              "netmask": "255.255.255.0",
              "status": "up"
            },
            "en1": {
              "status": "Wireless ignored"
            }
          }
        }
      },
      "InterfaceStatus": {
        "type": "string",
        "enum": [
          "Ok",
          "NoIPv4Address",
          "WirelessIgnored"
        ]
      },
      "Interfaces": {
        "type": "object",
        "description": "Container for interface API data",
        "required": [
          "interfaces"
        ],
        "properties": {
          "interfaces": {
            "$ref": "#/components/schemas/InterfaceApi"
          }
        }
      },
      "Legend": {
        "type": "object",
        "required": [
          "historyStart",
          "lowReturn",
          "mediumReturn",
          "strongReturn",
          "targetBorder",
          "pixelColors",
          "pixels"
        ],
        "properties": {
          "dopplerApproaching": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "minimum": 0
          },
          "dopplerReceding": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "minimum": 0
          },
          "historyStart": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "lowReturn": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "mediumReturn": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "pixelColors": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "pixels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Lookup"
            }
          },
          "strongReturn": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "targetBorder": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "Lookup": {
        "type": "object",
        "required": [
          "type",
          "color"
        ],
        "properties": {
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "type": {
            "$ref": "#/components/schemas/PixelType"
          }
        }
      },
      "PathSubscribe": {
        "type": "object",
        "description": "A single path subscription specification",
        "required": [
          "path"
        ],
        "properties": {
          "minPeriod": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "Minimum period between updates in milliseconds",
            "example": 200,
            "minimum": 0
          },
          "path": {
            "type": "string",
            "description": "Path pattern to subscribe to. Supports wildcards:\n- `radars.*.controls.*` - all controls on all radars\n- `radars.nav1034A.controls.gain` - specific control\n- `*.gain` - gain control on all radars",
            "example": "radars.*.controls.*"
          },
          "period": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "Update period in milliseconds (for fixed policy)",
            "example": 1000,
            "minimum": 0
          },
          "policy": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/Policy",
                "description": "Delivery policy: instant (immediate), ideal (rate-limited), fixed (periodic)"
              }
            ]
          }
        }
      },
      "PixelType": {
        "type": "string",
        "enum": [
          "normal",
          "targetBorder",
          "dopplerApproaching",
          "dopplerReceding",
          "history"
        ]
      },
      "Policy": {
        "type": "string",
        "description": "Subscription delivery policy",
        "enum": [
          "Instant",
          "Ideal",
          "Fixed"
        ]
      },
      "RadarApiV3": {
        "type": "object",
        "description": "Information about a detected radar, including WebSocket URLs for data streams",
        "required": [
          "name",
          "brand",
          "spokeDataUrl",
          "streamUrl",
          "radarIpAddress"
        ],
        "properties": {
          "brand": {
            "type": "string",
            "description": "Radar manufacturer brand (Navico, Furuno, Raymarine, Garmin)",
            "example": "Navico"
          },
          "model": {
            "type": [
              "string",
              "null"
            ],
            "description": "Radar model name if detected",
            "example": "HALO"
          },
          "name": {
            "type": "string",
            "description": "User-defined name or auto-detected model name",
            "example": "HALO 034A"
          },
          "radarIpAddress": {
            "type": "string",
            "description": "IP address of the radar unit on the network",
            "example": "192.168.1.50"
          },
          "spokeDataUrl": {
            "type": "string",
            "description": "WebSocket URL for receiving raw radar spoke data (binary)",
            "example": "ws://192.168.1.100:8080/signalk/v2/api/vessels/self/radars/nav1034A/spokes"
          },
          "streamUrl": {
            "type": "string",
            "description": "WebSocket URL for Signal K control stream (JSON)",
            "example": "ws://192.168.1.100:8080/signalk/v1/stream"
          }
        },
        "example": {
          "brand": "Navico",
          "model": "HALO",
          "name": "HALO 034A",
          "radarIpAddress": "192.168.1.50",
          "spokeDataUrl": "ws://192.168.1.100:8080/signalk/v2/api/vessels/self/radars/nav1034A/spokes",
          "streamUrl": "ws://192.168.1.100:8080/signalk/v1/stream"
        }
      },
      "RadarControlIdParam": {
        "type": "object",
        "description": "Parameters for control-specific endpoints",
        "required": [
          "radar_id",
          "control_id"
        ],
        "properties": {
          "control_id": {
            "type": "string",
            "description": "Control identifier (e.g., 'gain', 'range', 'sea')",
            "example": "gain"
          },
          "radar_id": {
            "type": "string",
            "description": "Radar identifier (e.g., 'nav1034A')",
            "example": "nav1034A"
          }
        }
      },
      "RadarControlValue": {
        "type": "object",
        "description": "Client-to-server message to set a radar control value via WebSocket stream.\n\nUsed in the `/signalk/v1/stream` WebSocket to send control commands.\nThe path identifies which radar and control to modify.",
        "required": [
          "path"
        ],
        "properties": {
          "auto": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Enable/disable automatic mode for controls that support it",
            "example": false
          },
          "autoValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "Current auto-computed value (read-only, server-to-client only)"
          },
          "enabled": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Enable/disable the control (for guard zones)",
            "example": true
          },
          "endDistance": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "End distance for guard zones (meters)",
            "example": 500.0
          },
          "endValue": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "End angle for guard zones (degrees)",
            "example": 90.0
          },
          "path": {
            "type": "string",
            "description": "Full path to the control: \"radars.{radarId}.controls.{controlId}\"",
            "example": "radars.nav1034A.controls.gain"
          },
          "startDistance": {
            "type": [
              "number",
              "null"
            ],
            "format": "double",
            "description": "Start distance for guard zones (meters)",
            "example": 100.0
          },
          "value": {
            "description": "The value to set (type depends on control: number, boolean, or string)"
          }
        },
        "example": {
          "path": "radars.nav1034A.controls.gain",
          "value": 50
        }
      },
      "RadarInterfaceApi": {
        "type": "object",
        "description": "Information about a network interface and its radar listeners",
        "required": [
          "status"
        ],
        "properties": {
          "ip": {
            "type": [
              "string",
              "null"
            ],
            "description": "IPv4 address assigned to this interface",
            "example": "192.168.1.100"
          },
          "listeners": {
            "type": [
              "object",
              "null"
            ],
            "description": "Map of radar brand to listener status message",
            "additionalProperties": {
              "type": "string"
            },
            "propertyNames": {
              "type": "string"
            },
            "example": {
              "Navico": "Active"
            }
          },
          "netmask": {
            "type": [
              "string",
              "null"
            ],
            "description": "Network mask for this interface",
            "example": "255.255.255.0"
          },
          "status": {
            "$ref": "#/components/schemas/InterfaceStatus"
          }
        },
        "example": {
          "ip": "192.168.1.100",
          "listeners": {
            "Furuno": "No match for 172.31.255.255",
            "Navico": "Active",
            "Raymarine": "Listening"
          },
          "netmask": "255.255.255.0"
        }
      },
      "RadarInterfaces": {
        "type": "object",
        "description": "Wrapper for radar interface information following Signal K structure",
        "required": [
          "radars"
        ],
        "properties": {
          "radars": {
            "$ref": "#/components/schemas/Interfaces"
          }
        },
        "example": {
          "radars": {
            "interfaces": {
              "brands": [
                "Navico",
                "Furuno",
                "Raymarine"
              ],
              "interfaces": {
                "en0": {
                  "ip": "192.168.1.100",
                  "listeners": {
                    "Furuno": "No match for 172.31.255.255",
                    "Navico": "Active",
                    "Raymarine": "Listening"
                  },
                  "netmask": "255.255.255.0"
                }
              }
            }
          }
        }
      },
      "RadarsResponse": {
        "type": "object",
        "description": "Response containing all active radars keyed by radar ID",
        "required": [
          "version",
          "radars"
        ],
        "properties": {
          "radars": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/RadarApiV3"
            },
            "propertyNames": {
              "type": "string"
            }
          },
          "version": {
            "type": "string"
          }
        },
        "example": {
          "radars": {
            "nav1034A": {
              "brand": "Navico",
              "model": "HALO",
              "name": "HALO 034A",
              "radarIpAddress": "192.168.1.50",
              "spokeDataUrl": "ws://192.168.1.100:8080/signalk/v2/api/vessels/self/radars/nav1034A/spokes",
              "streamUrl": "ws://192.168.1.100:8080/signalk/v1/stream"
            }
          },
          "version": "3.0.0"
        }
      },
      "SignalKDelta": {
        "type": "object",
        "description": "Server-to-client delta message containing control value updates",
        "required": [
          "updates"
        ],
        "properties": {
          "updates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeltaUpdate"
            },
            "description": "Array of update batches, each containing changed control values"
          }
        },
        "example": {
          "updates": [
            {
              "$source": "mayara",
              "timestamp": "2024-01-15T10:30:00Z",
              "values": [
                {
                  "path": "radars.nav1034A.controls.gain",
                  "value": 50
                },
                {
                  "auto": true,
                  "path": "radars.nav1034A.controls.sea",
                  "value": 30
                }
              ]
            }
          ]
        }
      },
      "Subscription": {
        "type": "object",
        "description": "Client-to-server message to subscribe to control value updates",
        "required": [
          "subscribe"
        ],
        "properties": {
          "subscribe": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PathSubscribe"
            },
            "description": "List of path subscriptions"
          }
        },
        "example": {
          "subscribe": [
            {
              "path": "radars.*.controls.*",
              "period": 1000
            },
            {
              "path": "radars.nav1034A.controls.gain",
              "policy": "instant"
            }
          ]
        }
      },
      "Units": {
        "type": "string",
        "enum": [
          "None",
          "Meters",
          "KiloMeters",
          "NauticalMiles",
          "MetersPerSecond",
          "Knots",
          "Degrees",
          "Radians",
          "RadiansPerSecond",
          "RotationsPerMinute",
          "Seconds",
          "Minutes",
          "Hours"
        ]
      }
    }
  },
  "tags": [
    {
      "name": "Radars",
      "description": "Radar discovery and capabilities"
    },
    {
      "name": "Controls",
      "description": "Read and modify radar control settings"
    },
    {
      "name": "Configuration",
      "description": "Server and network configuration"
    },
    {
      "name": "Stream",
      "description": "Real-time WebSocket stream for control updates"
    }
  ]
}
