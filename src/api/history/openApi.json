{
  "openapi": "3.0.0",
  "info": {
    "version": "0.0.1",
    "title": "Signal K History API",
    "license": {
      "name": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "servers": [
    {
      "url": "/signalk/v2/api/history"
    }
  ],
  "components": {},
  "security": [
    {
      "cookieAuth": []
    },
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/values": {
      "get": {
        "summary": "Retrieve historical data",
        "description": "Returns historical data series for the paths and time range specified in query parameters",
        "parameters": [
          {
            "in": "query",
            "name": "from",
            "description": "Start of the time range, inclusive as ISO 8601 timestamp",
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "in": "query",
            "name": "duration",
            "description": "Duration of the time range in milliseconds (integer) or as an ISO8601 Duration string. Can be specified with either 'from' or 'to'. If they are both omitted is relative to 'now'. See https://datatracker.ietf.org/doc/html/rfc3339#appendix-A",
            "schema": {
              "oneOf": [
                {
                  "type": "integer",
                  "description": "Duration in milliseconds"
                },
                {
                  "type": "string",
                  "format": "duration",
                  "description": "ISO8601 Duration string"
                }
              ]
            }
          },
          {
            "in": "query",
            "name": "to",
            "description": "End of the time range, inclusive. 'Now' if omitted",
            "schema": {
              "type": "string",
              "format": "date-time"
            },
            "required": true
          },
          {
            "in": "query",
            "name": "context",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "resolution",
            "description": "Length of data sample time window in milliseconds or as a time expression ('1s', '1m', '1h', '1d')",
            "schema": {
              "type": "number",
              "format": "integer"
            }
          },
          {
            "in": "query",
            "name": "paths",
            "description": "Comma separated ist of Signal K paths whose data should be retrieved, optional aggregation methods for each path as postfix separated by a colon. Aggregation methods: 'average' | 'min' | 'max' | 'first' | 'last' | 'mid' | 'middle_index'",
            "example": "navigation.speedOverGround,navigation.speedThroughWater:max",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Series data with header",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["context", "", "target"],
                  "properties": {
                    "context": {
                      "type": "string",
                      "description": "Signal K context that the data is about",
                      "example": "vessels.urn:mrn:imo:mmsi:123456789"
                    },
                    "range": {
                      "type": "object",
                      "properties": {
                        "from": {
                          "type": "string",
                          "format": "date-time",
                          "description": "Start of the time range, inclusive, as UTC timestamp",
                          "example": "2018-03-20T09:12:28Z"
                        },
                        "to": {
                          "type": "string",
                          "format": "date-time",
                          "description": "End of the time range, inclusive, as UTC timestamp",
                          "example": "2018-03-20T09:13:28Z"
                        }
                      }
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "path": {
                            "type": "string",
                            "description": "Signal K path"
                          },
                          "method": {
                            "type": "string",
                            "description": "Aggregation method"
                          }
                        }
                      }
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "array",
                        "items": {
                          "description": "Data for a point in time. The first array element is the timestamp in ISO 8601 format. Missing data for a path is returned as null",
                          "oneOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "null"
                            },
                            {
                              "type": "array",
                              "items": {
                                "type": "number"
                              }
                            }
                          ]
                        }
                      },
                      "example": [
                        ["2023-11-09T02:45:38.160Z", 13.2, null, [-120.5, 59.2]]
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/contexts": {
      "get": {}
    },
    "/paths": {
      "get": {}
    }
  }
}
